import{g as ie,b as ae,s as Y,m as le,r as d,c as ce,d as de,e as pe,f as he,j as e,h as ue,i as me,k as xe,l as ge,n as X,o as K,B as j,L as G,p as fe,C as H,a as W,P as ye}from"./index-Clq8qEyb.js";import{A as Ce}from"./AccessTime-DG6SJxDn.js";import{a as A}from"./constants-Dd5hli-r.js";import{L as J}from"./List-C9zJ7A1r.js";import{D as we,a as je,b as Ee,c as ve}from"./DialogTitle-Cmnx9Rjh.js";import{F as be,C as ze}from"./FormControlLabel-COX3Jitj.js";function Se(i){return ae("MuiCollapse",i)}ie("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const $e=i=>{const{orientation:o,classes:p}=i,m={root:["root",`${o}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${o}`],wrapperInner:["wrapperInner",`${o}`]};return me(m,Se,p)},Ae=Y("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(i,o)=>{const{ownerState:p}=i;return[o.root,o[p.orientation],p.state==="entered"&&o.entered,p.state==="exited"&&!p.in&&p.collapsedSize==="0px"&&o.hidden]}})(le(({theme:i})=>({height:0,overflow:"hidden",transition:i.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:i.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:o})=>o.state==="exited"&&!o.in&&o.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),Re=Y("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(i,o)=>o.wrapper})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Te=Y("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(i,o)=>o.wrapperInner})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),V=d.forwardRef(function(o,p){const m=ce({props:o,name:"MuiCollapse"}),{addEndListener:R,children:T,className:x,collapsedSize:g="0px",component:U,easing:E,in:f,onEnter:D,onEntered:y,onEntering:v,onExit:I,onExited:P,onExiting:M,orientation:k="vertical",style:C,timeout:h=xe.standard,TransitionComponent:N=ge,...t}=m,s={...m,orientation:k,collapsedSize:g},a=$e(s),b=de(),l=pe(),n=d.useRef(null),O=d.useRef(),B=typeof g=="number"?`${g}px`:g,z=k==="horizontal",S=z?"width":"height",L=d.useRef(null),Z=he(p,L),w=r=>c=>{if(r){const u=L.current;c===void 0?r(u):r(u,c)}},q=()=>n.current?n.current[z?"clientWidth":"clientHeight"]:0,_=w((r,c)=>{n.current&&z&&(n.current.style.position="absolute"),r.style[S]=B,D&&D(r,c)}),ee=w((r,c)=>{const u=q();n.current&&z&&(n.current.style.position="");const{duration:$,easing:F}=X({style:C,timeout:h,easing:E},{mode:"enter"});if(h==="auto"){const Q=b.transitions.getAutoHeightDuration(u);r.style.transitionDuration=`${Q}ms`,O.current=Q}else r.style.transitionDuration=typeof $=="string"?$:`${$}ms`;r.style[S]=`${u}px`,r.style.transitionTimingFunction=F,v&&v(r,c)}),te=w((r,c)=>{r.style[S]="auto",y&&y(r,c)}),re=w(r=>{r.style[S]=`${q()}px`,I&&I(r)}),oe=w(P),se=w(r=>{const c=q(),{duration:u,easing:$}=X({style:C,timeout:h,easing:E},{mode:"exit"});if(h==="auto"){const F=b.transitions.getAutoHeightDuration(c);r.style.transitionDuration=`${F}ms`,O.current=F}else r.style.transitionDuration=typeof u=="string"?u:`${u}ms`;r.style[S]=B,r.style.transitionTimingFunction=$,M&&M(r)}),ne=r=>{h==="auto"&&l.start(O.current||0,r),R&&R(L.current,r)};return e.jsx(N,{in:f,onEnter:_,onEntered:te,onEntering:ee,onExit:re,onExited:oe,onExiting:se,addEndListener:ne,nodeRef:L,timeout:h==="auto"?null:h,...t,children:(r,c)=>e.jsx(Ae,{as:U,className:ue(a.root,x,{entered:a.entered,exited:!f&&B==="0px"&&a.hidden}[r]),style:{[z?"minWidth":"minHeight"]:B,...C},ref:Z,...c,ownerState:{...s,state:r},children:e.jsx(Re,{ownerState:{...s,state:r},className:a.wrapper,ref:n,children:e.jsx(Te,{ownerState:{...s,state:r},className:a.wrapperInner,children:T})})})})});V&&(V.muiSupportAuto=!0);const De=K(e.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Ie=K(e.jsx("path",{d:"M9 1h6v2H9zm10.03 6.39 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M13 14h-2V8h2z"}),"Timer"),Me=K(e.jsx("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2z"}),"Repeat"),Ue=()=>{const i=sessionStorage.getItem("token"),[o,p]=d.useState([]),[m,R]=d.useState([]),[T,x]=d.useState(null),[g,U]=d.useState({}),[E,f]=d.useState([]),[D,y]=d.useState(!1),[v,I]=d.useState(null);function P(t,s){if(!Array.isArray(t)||!Array.isArray(s))throw new Error("Invalid input: selectedIds and emails must be arrays.");return s.filter(a=>t.includes(a.id))}d.useEffect(()=>{console.log("start"),(async()=>{try{const n=await(await fetch(`${A}/campaigns/all`,{headers:{Authorization:`Bearer ${i}`}})).json();Array.isArray(n)?p(n):x("Invalid data format received from the server.")}catch(l){x("Error fetching campaigns: "+l.message)}})(),(async()=>{try{const n=await(await fetch(`${A}/accounts/users-email-list`,{headers:{Authorization:`Bearer ${i}`}})).json();R(n),console.log(n),console.log(o)}catch(l){x("Error fetching emails: "+l.message)}})(),(async()=>{try{const n=await(await fetch(`${A}/auth/admin`,{headers:{Authorization:`Bearer ${i}`}})).json();n&&console.log(n.message)}catch(l){x("Error fetching campaigns: "+l.message)}})(),(async()=>{try{const n=await(await fetch(`${A}/auth/profile`,{headers:{Authorization:`Bearer ${i}`}})).json();n&&console.log(n.message)}catch(l){x("Error fetching campaigns: "+l.message)}})()},[]);const M=t=>{U(s=>({...s,[t]:!s[t]}))},k=t=>{console.log(t),I(t),f([]),y(!0)},C=()=>{y(!1)},h=t=>{f(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t])},N=async()=>{const t=P(E,m);try{const a=await(await fetch(`${A}/campaigns/${v}/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({campaignId:v,initiator:t})})).text();alert(a),y(!1),f([])}catch(s){alert("Failed to start campaign: "+s.message)}};return e.jsxs(j,{sx:{display:"flex"},children:[e.jsx(j,{sx:{flexGrow:1,p:4,overflowY:"auto",maxWidth:"1000px"},children:e.jsxs(j,{children:[e.jsx("h2",{children:"Campaign Dashboard ðŸ“ƒ"}),T&&e.jsx("div",{style:{color:"red"},children:T}),e.jsx(j,{sx:{padding:2,borderRadius:"20px",backgroundColor:"primary.light",color:"primary.main",border:"2px solid",borderColor:"primary.main"},children:e.jsx(J,{children:o.length>0?o.map((t,s)=>e.jsxs(G,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",mb:2,borderBottom:s===o.length-1?"none":"2px solid #ddd"},children:[e.jsx(fe,{primary:t.name,secondary:`Target Audience: ${t.targetAudience}`}),e.jsxs(j,{sx:{display:"flex",alignItems:"center",width:"100%",flexWrap:"wrap",gap:"1rem"},children:[e.jsx(H,{label:t.status,color:t.status==="draft"?"primary":"default",sx:{marginRight:2,cursor:"pointer",border:"1px solid",borderColor:"white","&:hover":{color:"primary.main",backgroundColor:"white",border:"1px solid",borderColor:"primary.main"}}}),e.jsx(H,{label:new Date(t.createdAt).toLocaleString("en-US",{hour:"numeric",minute:"numeric",day:"numeric",month:"short",year:"numeric"}),icon:e.jsx(Ce,{}),color:"secondary",variant:"outlined",sx:{borderRadius:"20px",padding:"5px 10px",fontSize:"0.875rem",cursor:"pointer","&:hover":{backgroundColor:"secondary.main",color:"white",border:"1px solid",borderColor:"secondary.main"}}}),e.jsx(H,{label:`Frequency: ${t.frequency}`,icon:e.jsx(Me,{}),color:"secondary",variant:"outlined",sx:{borderRadius:"20px",padding:"5px 10px",fontSize:"0.875rem",cursor:"pointer","&:hover":{backgroundColor:"secondary.main",color:"white",border:"1px solid",borderColor:"secondary.main"}}}),e.jsx(H,{label:`Interval: ${t.interval}`,icon:e.jsx(Ie,{}),color:"secondary",variant:"outlined",sx:{borderRadius:"20px",padding:"5px 10px",fontSize:"0.875rem",cursor:"pointer","&:hover":{backgroundColor:"secondary.main",color:"white",border:"1px solid",borderColor:"secondary.main"}}}),e.jsx(W,{variant:"contained",color:"success",sx:{ml:2},onClick:()=>k(t.id),children:"Start"})]}),e.jsxs(j,{sx:{mt:2,width:"100%"},children:[e.jsx(W,{size:"small",startIcon:e.jsx(De,{}),onClick:()=>M(t.id),children:g[t.id]?"Hide Emails":"Show Emails"}),e.jsx(V,{in:g[t.id],children:e.jsx(J,{dense:!0,children:(t.emails||[]).map((a,b)=>e.jsx(G,{children:e.jsx(ye,{sx:{padding:"8px 16px",backgroundColor:"primary.main",borderRadius:"10px",color:"white",width:"100%"},children:a})},b))})})]})]},t.id)):e.jsx("div",{children:"No campaigns found."})})})]})}),e.jsxs(we,{open:D,onClose:C,children:[e.jsx(je,{children:"Select Emails"}),e.jsx(Ee,{children:e.jsx(J,{children:m.length>0?m.map(t=>e.jsx(G,{children:e.jsx(be,{control:e.jsx(ze,{checked:E.includes(t.id),onChange:()=>h(t.id)}),label:t.email})},t.id)):""})}),e.jsxs(ve,{children:[e.jsx(W,{onClick:C,color:"secondary",children:"Cancel"}),e.jsx(W,{onClick:N,color:"primary",children:"Start Campaign"})]})]})]})};export{Ue as default};
