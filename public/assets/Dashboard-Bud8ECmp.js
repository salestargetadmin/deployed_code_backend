import{g as ie,c as ae,s as K,m as le,r as c,d as ce,e as de,f as pe,h as he,j as e,i as ue,k as me,l as xe,n as ye,o as X,p as P,B as w,L as G,q as fe,C as H,t as ge,I as Ce,a as J,P as je,v as we,b as $}from"./index-BkklOD1L.js";import{A as Ee}from"./AccessTime-B3521hzo.js";import{L as V}from"./List-D_zX7YuV.js";import{D as ve,a as be,b as Se,c as ze}from"./DialogTitle-B0-RsWys.js";import{F as Ae,C as $e}from"./FormControlLabel-DqzpyEZO.js";function Ie(i){return ae("MuiCollapse",i)}ie("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Re=i=>{const{orientation:s,classes:d}=i,m={root:["root",`${s}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${s}`],wrapperInner:["wrapperInner",`${s}`]};return me(m,Ie,d)},Te=K("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(i,s)=>{const{ownerState:d}=i;return[s.root,s[d.orientation],d.state==="entered"&&s.entered,d.state==="exited"&&!d.in&&d.collapsedSize==="0px"&&s.hidden]}})(le(({theme:i})=>({height:0,overflow:"hidden",transition:i.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:i.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:s})=>s.state==="exited"&&!s.in&&s.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),De=K("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(i,s)=>s.wrapper})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Me=K("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(i,s)=>s.wrapperInner})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),Y=c.forwardRef(function(s,d){const m=ce({props:s,name:"MuiCollapse"}),{addEndListener:I,children:R,className:x,collapsedSize:y="0px",component:W,easing:E,in:f,onEnter:T,onEntered:g,onEntering:v,onExit:D,onExited:U,onExiting:M,orientation:k="vertical",style:C,timeout:u=xe.standard,TransitionComponent:O=ye,...t}=m,n={...m,orientation:k,collapsedSize:y},a=Re(n),b=de(),l=pe(),o=c.useRef(null),N=c.useRef(),L=typeof y=="number"?`${y}px`:y,S=k==="horizontal",z=S?"width":"height",B=c.useRef(null),Z=he(d,B),j=r=>p=>{if(r){const h=B.current;p===void 0?r(h):r(h,p)}},q=()=>o.current?o.current[S?"clientWidth":"clientHeight"]:0,_=j((r,p)=>{o.current&&S&&(o.current.style.position="absolute"),r.style[z]=L,T&&T(r,p)}),ee=j((r,p)=>{const h=q();o.current&&S&&(o.current.style.position="");const{duration:A,easing:F}=X({style:C,timeout:u,easing:E},{mode:"enter"});if(u==="auto"){const Q=b.transitions.getAutoHeightDuration(h);r.style.transitionDuration=`${Q}ms`,N.current=Q}else r.style.transitionDuration=typeof A=="string"?A:`${A}ms`;r.style[z]=`${h}px`,r.style.transitionTimingFunction=F,v&&v(r,p)}),te=j((r,p)=>{r.style[z]="auto",g&&g(r,p)}),re=j(r=>{r.style[z]=`${q()}px`,D&&D(r)}),se=j(U),ne=j(r=>{const p=q(),{duration:h,easing:A}=X({style:C,timeout:u,easing:E},{mode:"exit"});if(u==="auto"){const F=b.transitions.getAutoHeightDuration(p);r.style.transitionDuration=`${F}ms`,N.current=F}else r.style.transitionDuration=typeof h=="string"?h:`${h}ms`;r.style[z]=L,r.style.transitionTimingFunction=A,M&&M(r)}),oe=r=>{u==="auto"&&l.start(N.current||0,r),I&&I(B.current,r)};return e.jsx(O,{in:f,onEnter:_,onEntered:te,onEntering:ee,onExit:re,onExited:se,onExiting:ne,addEndListener:oe,nodeRef:B,timeout:u==="auto"?null:u,...t,children:(r,{ownerState:p,...h})=>e.jsx(Te,{as:W,className:ue(a.root,x,{entered:a.entered,exited:!f&&L==="0px"&&a.hidden}[r]),style:{[S?"minWidth":"minHeight"]:L,...C},ref:Z,ownerState:{...n,state:r},...h,children:e.jsx(De,{ownerState:{...n,state:r},className:a.wrapper,ref:o,children:e.jsx(Me,{ownerState:{...n,state:r},className:a.wrapperInner,children:R})})})})});Y&&(Y.muiSupportAuto=!0);const ke=P(e.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),Le=P(e.jsx("path",{d:"M9 1h6v2H9zm10.03 6.39 1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61M13 14h-2V8h2z"}),"Timer"),Be=P(e.jsx("path",{d:"M7 7h10v3l4-4-4-4v3H5v6h2zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2z"}),"Repeat"),Fe=P(e.jsx("path",{d:"M10 8.64 15.27 12 10 15.36zM8 5v14l11-7z"}),"PlayArrowOutlined"),Ne=()=>{const i=sessionStorage.getItem("token"),[s,d]=c.useState([]),[m,I]=c.useState([]),[R,x]=c.useState(null),[y,W]=c.useState({}),[E,f]=c.useState([]),[T,g]=c.useState(!1),[v,D]=c.useState(null);function U(t,n){if(!Array.isArray(t)||!Array.isArray(n))throw new Error("Invalid input: selectedIds and emails must be arrays.");return n.filter(a=>t.includes(a.id))}c.useEffect(()=>{(async()=>{try{const o=await(await fetch(`${$}/campaigns/all`,{headers:{Authorization:`Bearer ${i}`}})).json();Array.isArray(o)?d(o):x("Invalid data format received from the server.")}catch(l){x("Error fetching campaigns: "+l.message)}})(),(async()=>{try{const o=await(await fetch(`${$}/accounts/users-email-list`,{headers:{Authorization:`Bearer ${i}`}})).json();I(o)}catch(l){x("Error fetching emails: "+l.message)}})(),(async()=>{try{const o=await(await fetch(`${$}/auth/admin`,{headers:{Authorization:`Bearer ${i}`}})).json();o&&console.log(o.message)}catch(l){x("Error fetching campaigns: "+l.message)}})(),(async()=>{try{const o=await(await fetch(`${$}/auth/profile`,{headers:{Authorization:`Bearer ${i}`}})).json();o&&console.log(o.message)}catch(l){x("Error fetching campaigns: "+l.message)}})()},[]);const M=t=>{W(n=>({...n,[t]:!n[t]}))},k=t=>{console.log(t),D(t),f([]),g(!0)},C=()=>{g(!1)},u=t=>{f(n=>n.includes(t)?n.filter(a=>a!==t):[...n,t])},O=async()=>{const t=U(E,m);try{const a=await(await fetch(`${$}/campaigns/${v}/start`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({campaignId:v,initiator:t})})).text();alert(a),g(!1),f([])}catch(n){alert("Failed to start campaign: "+n.message)}};return e.jsxs(w,{sx:{display:"flex"},children:[e.jsx(w,{sx:{flexGrow:1,p:4,overflowY:"auto",maxWidth:"1200px"},children:e.jsxs(w,{children:[e.jsx("h2",{children:"Campaign Dashboard ðŸ“ƒ"}),R&&e.jsx("div",{style:{color:"red"},children:R}),e.jsx(w,{sx:{padding:2,borderRadius:"20px"},children:e.jsx(V,{children:s.length>0?s.map((t,n)=>e.jsxs(G,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",borderRadius:"8px",boxShadow:"0 1px 8px 0 #D9D9D9",mb:2,p:2},children:[e.jsx(fe,{primary:t.name,secondary:`Target Audience: ${t.targetAudience}`,sx:{"& .MuiListItemText-secondary":{color:"secondary.main"}}}),e.jsxs(w,{sx:{display:"flex",alignItems:"center",width:"100%",flexWrap:"wrap",gap:"1rem"},children:[e.jsx(H,{label:t.status,color:t.status==="draft"?"primary":"default",sx:{marginRight:2,cursor:"pointer",border:"2px solid",borderColor:"secondary.main","&:hover":{color:"primary.main",backgroundColor:"secondary.main",borderColor:"primary.main"}}}),e.jsx(H,{label:new Date(t.createdAt).toLocaleString("en-US",{hour:"numeric",minute:"numeric",day:"numeric",month:"short",year:"numeric"}),icon:e.jsx(Ee,{}),color:"secondary",variant:"outlined",sx:{borderRadius:"20px",padding:"5px 10px",fontSize:"0.875rem",border:"2px solid",cursor:"pointer","&:hover":{color:"primary.main",backgroundColor:"secondary.main",borderColor:"primary.main"}}}),e.jsx(H,{label:`Frequency: ${t.frequency}`,icon:e.jsx(Be,{}),color:"secondary",variant:"outlined",sx:{borderRadius:"20px",padding:"5px 10px",fontSize:"0.875rem",border:"2px solid",cursor:"pointer","&:hover":{color:"primary.main",backgroundColor:"secondary.main",borderColor:"primary.main"}}}),e.jsx(H,{label:`Interval: ${t.interval}`,icon:e.jsx(Le,{}),color:"secondary",variant:"outlined",sx:{borderRadius:"20px",padding:"5px 10px",fontSize:"0.875rem",border:"2px solid",cursor:"pointer","&:hover":{color:"primary.main",backgroundColor:"secondary.main",borderColor:"primary.main"}}}),e.jsx(ge,{title:"Start campaign",placement:"right",children:e.jsx(Ce,{"aria-label":"delete",color:"success",onClick:()=>k(t.id),children:e.jsx(Fe,{})})})]}),e.jsxs(w,{sx:{mt:2,width:"100%"},children:[e.jsx(J,{size:"small",startIcon:e.jsx(ke,{}),onClick:()=>M(t.id),color:"secondary.main",children:y[t.id]?"Hide Emails":"Show Emails"}),e.jsx(Y,{in:y[t.id],children:e.jsx(V,{dense:!0,children:(t.emails||[]).map((a,b)=>e.jsx(G,{children:e.jsx(je,{sx:{padding:"8px 16px",backgroundColor:"primary.main",borderRadius:"10px",color:"secondary.main",width:"100%",border:"2px solid",borderColor:"secondary.main"},children:a})},b))})})]})]},t.id)):e.jsx(we,{})})})]})}),e.jsxs(ve,{open:T,onClose:C,children:[e.jsx(be,{children:"Select Emails"}),e.jsx(Se,{children:e.jsx(V,{children:m.length>0?m.map(t=>e.jsx(G,{children:e.jsx(Ae,{control:e.jsx($e,{checked:E.includes(t.id),onChange:()=>u(t.id)}),label:t.email})},t.id)):""})}),e.jsxs(ze,{children:[e.jsx(J,{onClick:C,color:"primary",children:"Cancel"}),e.jsx(J,{onClick:O,color:"primary",children:"Start Campaign"})]})]})]})};export{Ne as default};
